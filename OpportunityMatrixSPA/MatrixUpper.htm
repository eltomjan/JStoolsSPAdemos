<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0072)http://localhost/rich.nsf/MatrixUpper -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "">
<HTML>
    <HEAD>
        <META content="IE=5.0000" http-equiv="X-UA-Compatible">
        <TITLE>Opportunity Matrix</TITLE>
        <META http-equiv="Content-Type" content="text/html; charset=utf-8">
        <BASEFONT face="Verdana"></BASEFONT>
        <STYLE>
            input {
                font-family: Verdana;
                font-size: 12px;
            }

            select {
                font-family: Verdana;
                font-size: 12px;
            }

            td {
                font-family: Verdana;
                font-size: 10px;
            }
        </STYLE>
<SCRIPT language="JavaScript">var isBD=0;</SCRIPT>
<SCRIPT language="JavaScript" type="text/javascript">
var h;
function testing() {
for(a=0;a<dcm.forms.length;a++) {
c=0;
for(b=0;b<dcm.forms[a];b++) if(!dcm.forms[a][b].name) c=1;
if(c) alert(dcm.forms[a].outerHTML)
}}

a=window.clientInformation;
a=a.appVersion+a.userAgent;
if(a.indexOf('Windows 98')>0) w98=1; else w98=0;
//w98=1

// počátek,od,do,počet
var pos='0|0|0|0'.split('|');
var maxopps=15;
var cls;
if(parent.menu.cls) parent.window.close()
var hrc;
var rest;
var run=1;
var dcm=parent.data.document;
parent.menu.dcm=parent.data.document;
var typem=0,onld0,onld1,astme=35;
var reread=1;
var interv;
var newdocs=0;
var allowed='';
var seg='QSR|Casual Dining|Asian|Pizza|Italian|Dinnerhouse|Distibutor|Chicken|Coffee/Snacks|Seafood|Family Dining|Buffet/Cafeteria|Steak/Barbecue|Sandwiches Bakery|C-Stores|Contract Management|Lodging|Industrial|Distributor|Other'.split('|');
var productf='prunid|Category|SUB|SKU|Description|Price|unit|Total|Segment|FunnelPosition|ShipDate|Priority|PriorityN|';
var generalf=('docid|ProspectName|Initiative|'+productf).split("|");
productf=productf.split("|");
var par,sub,sku,pg,pn,days,pl,ap,itot,iexp,st,days,del;
var xx=new Array;
var beingsaved=0;
var sv=0;
var dbpath = parent.location.href.substr(0, parent.location.href.indexOf(".nsf") + 4);
var prhd='<TD WIDTH=21 bgcolor=CCCCCC>Pr.</TD><TD width=40 bgcolor=CCCCCC>Num.</TD><TD width=20></TD><td width=201>ACCOUNT</td><td width=156>OPPORTUNITY</td>'+
(isBD?'':'<td width=148>SEGMENT</td>')+
'<td width=123>STAGE</td><td width=84>EST. SHIP DATE</td>'
function svtst() {
for (a=1;a<dcm.forms.length;a++)
 if (dcm.forms[a].save)
	if (dcm.forms[a].save.checked) return false
return true
}

function prev() {
if(pos[0]>1) if(svtst()) {
	b=0;c=0;
	pr=pl[0][0].substr(1,32);
//	pos[0]=pl.length
	for(a=0;a<pl.length&&a<pos[0];a++) {
		b++;if(pl[a][3]) b++;
		if(pr!=pl[a][0].substr(1,32)) {
			pr=pl[a][0].substr(1,32);
			if(b>=maxopps) {b=1;if(pl[a][3]) b++;if(a<pos[0]){c=a}}
		}
	}
	pos[0]=c;
	pos[3]=0;
	dcm.body.innerHTML="";
	posx=pos.join('|');
	posm=0
	onl(0)
} else alert('Save changes first !')
}

function next() {
if((pos[2]+1)<pl.length) if(svtst()) {
	pos[0]=pos[2]+1;
	pos[3]=0;
	dcm.body.innerHTML="";
	posx=pos.join('|');
	posm=0
	onl(0)
} else alert('Save changes first !')
//alert(pos+'x'+pl.length)
}

function hid() {this.style.visibility='hidden'}
function clr() {
t=this
if(event.type=='mouseout') {
	c='';
	t.bgColor=''
} else {
	if(t.parentElement.id == "m") {
	c='0';
	l=document.body.clientWidth-m.offsetWidth;
	for(a=0;a<m.cells.length;a++) if(m.cells[a].firstElementChild && m.cells[a].firstElementChild.style) {
		l+=m.cells[a].offsetWidth;
		m.cells[a].firstElementChild.style.left=l-m.cells[a].firstElementChild.offsetWidth+2;
		m.cells[a].firstElementChild.style.zIndex=50;
		} else l+=m.cells[a].offsetWidth;
	} else c='666666'
}
x=t.parentElement
for (a=0;a<x.cells.length;a+=2) if(x.cells[a]!=t) {
	x.cells[a].bgColor=''
    if (m.cells[a].firstElementChild) {
        b=x.cells[a].firstElementChild.style
	if(b) b.visibility='hidden'
    }
} else {
if(c!='') {
	x.cells[a].bgColor=c;
    if (m.cells[a].firstElementChild) {
        b=x.cells[a].firstElementChild.style
	if(b) b.visibility='visible';
    }
} else if(event.offsetY<0||event.offsetX<0||event.offsetWidth==x.offsetX) {
    if (m.cells[a].firstElementChild) {
        b=x.cells[a].firstElementChild.style
	if(b) b.visibility='hidden';
    }
}}
}

var posx;
function svcl(t) {
//save.innerText = "saving...";
window.clearInterval(interv)
if (sve(0)) {
    var x=sv, y={}, o="";
    while(x) {
        var l = x.substr(0,3);
        x=x.substr(3);
        var z=x.substr(0,l);
        var l2=x.substr(0,3);
        if(z.substr(3+l2*1)) o+=z.substr(3,l2)+':'+z.substr(3+l2*1)+'\n';
        x=x.substr(l);
    }
    alert('Would send (de-/)encoded data:\n'+o+'\n'+sv);
    f=dcm.forms[0];
    h=window.document.location.href;
    f.Stages.value=h.substr(0,h.indexOf('.nsf'));
    if(posx) posm=posx; else posm='0|0|0|0';
    //f.submit();
    if(t) {
        parent.onbeforeunload=''
        parent.menu.cls=1
    //parent.close()
    }
} else {
    beingsaved=0;
    interv=window.setInterval("autosave()",5000);
    save.innerText = "";
    status="Save stopped."
}}

function totalall() {
status="Counting...";
bx=1;
sm=0;
var ct=0;
for(a=0;a<pl.length;a++) if(a<pos[0]||a>pos[2]) {
if(pl[a][3]) {
b=parseFloat(pl[a][gfnum('Total')].replace(/,/g,''));
if(!isNaN(b)) sm+=b;
b=parseFloat(pl[a][gfnum('unit')].replace(/,/g,''));
if(!isNaN(b)) ct+=b;
}}
while (bx<dcm.forms.length) {
x=dcm.forms[bx];
if (x.id=='total') {
total(dcm.all[dcm.forms[bx].sourceIndex+1]);
b=total(dcm.all[dcm.forms[bx].sourceIndex+1]);
if(!isNaN(b)) sm+=b;
if(!dcm.forms[bx].cases) return;
b=parseFloat(dcm.forms[bx].cases.value.replace(/,/g,''));
if(!isNaN(b)) ct+=b;
}
bx++;
}
parent.menu.document.forms[0].totalall.value=putn(sm);
parent.menu.document.forms[0].cases.value=putn(ct);
status="Done";}

function wo(a,b) { window.open(a,"",b) };
function dlt(th) {
b=parent.data.getForm(parent.menu.getTR(parent.menu.getTab(th).parentElement).parentElement.firstElementChild.nextElementSibling, "ProspectName");
c=th.parentNode.parentNode==dcm.forms[1]
th=parent.menu.getTR(th);
for(a=0;a<dcm.forms.length;a++) {
if(dcm.forms[a].save) if(dcm.forms[a].save.checked) {
if(dcm.forms[a].id2) id2=dcm.forms[a].id2.substr(0,3); else id2='';
if(((id2!='new')&&(dcm.forms[a].id.substr(0,3)!='new'))||(dcm.forms[a]!=th)) {
	alert('Save changed documents first !')
	return false;
}}}
if(th.id2) id2=th.id2.substr(0,3); else id2='';
if((th.id.substr(0,3)=='new')&&c) return false;
if (confirm('Are you sure you want to delete this item ?')) {
if((id2.substr(0,3)=='new')||(th.id.substr(0,3)=='new')) {
	if(b) {
        b=th.rowIndex-1
		if(b) b--;
        a=parent.menu.getTR(th);
        a.parentElement.removeChild(a);
    } else parent.menu.getTR(th).deleteRow(th.parentNode.rowIndex);
} else {
th.save.checked=true;
if (th.ProspectName) id=th.id; else id=th.id2;
sv=id;
x=dcm.forms[0];
x.action="DeleteFromBlaster?OpenForm&Seq=1";
x.name="_DeleteFromBlaster";
x.Stages.value=window.parent.menu.location.href;
x.ProspectN_FOP.value=sv;
x.submit();
}}}

function hr() {
if (hrc=='FFFFFF') return ('<tr><td><img height=3></td></tr><tr><td colspan=8 bgcolor=EeEeEe><img height=4></td></tr>');
else return ('<tr><td colspan=8 bgcolor=EeEeEe><img height=4></td></tr><tr><td><img height=3></td></tr>');
}

function clean(type) {
if(typem==type) return false;
s=0; f=dcm.forms;
for(a=0;a<f.length;a++) if (f[a].save) if (f[a].save.checked) s=1;
if (s) {
answ=makeMsgBox('Unsaved documents','If you would like to save your changes, click Yes.\r\nIf you want to switch your view without saving, click No.\r\nIf you do not want to change your view, click Cancel.',48,3,512,0);
	if (answ==6) {
if (sve(0)) {
typem=1-typem;
f=dcm.forms[0];
h=window.dcm.location.href;
f.Stages.value=h.substr(0,h.indexOf('.nsf'));
f.submit();
}
	} else if (answ==7) {
     dcm.body.innerHTML="";
	onl(type)
	typem=type;
	} else document.forms[0].sw[1-type].checked=true;
} else {
     dcm.body.innerHTML="";
	onl(type)
	typem=type;
}
}

function slct(nme,i,b) {
//if(nme=='Segment') return '';
c='<option>- SELECT -</option>';
x='';
for (a=0;a<i.length;i++) {
if(b==i[a]) { sel=' selected'; c='';} else sel='';
x+='<option value=\"'+escp(i[a])+'"'+sel+'>'+i[a]+'</option>';
}
return('<select name='+nme+' onchange="parent.data.getForm(this,\"save\").checked=true" style="width=146px">'+c+x+'</select>');
}

function descr(th){
parent.data.getForm(th,"save").checked=true
x=parent.data.getForm(th,"SKU").options[th.selectedIndex]
x.selected=true;
x=x.value;
if(x!='ALL') {
if(x) x=x.split('|'); else x='||'.split('|')
parent.data.getForm(th, "Price").value=x[2];
}}

function nw(t) {var x;
var xx=new Array;
xx[0]='<input type=checkbox name=pr onclick=\'this.value=(this.checked)?"checked":"";parent.data.getForm(this,\"save\").checked=true;\')>'
xx[1]='<input name=num size=3 onchange="parent.data.getForm(this,\"save\").checked=true">'
xx[2]='<input type=checkbox name=save style="display:none">'+del;
xx[3]=prn('$internal$');
xx[4]='<input name=Initiative onchange=parent.data.getForm(this,\"save\").checked=true style="width:155px">'
xx[5]=(isBD?'':slct('Segment',seg,''))
xx[6]=stg(st)
xx[7]='<input name=ShipDate onchange=parent.data.getForm(this,\"save\").checked=true size=11>'; // readonly onclick="document.frames[0].calendar(this,event.clientY+document.body.scrollTop,event.clientX)"
if(t) {
a='<tr>'+prhd+'</tr><tr valign=top height=30 id=new0><form>'
for(b=0;b<8;b++) {
	if(xx[b]) a+='<td'+((b<2)?' bgcolor=cccccc':'')+'>'+xx[b]+'</td>'
}
b=dcm.body.innerHTML.indexOf('</TBODY>')
dcm.body.innerHTML=dcm.body.innerHTML.substr(0,b)+a+'</form></tr>'+
'<tr><td bgcolor=CCCCCC colspan=2></td><td colspan=4 align=right><table border=0 cellpadding=0 cellspacing=0 style="font-size:12px; font-weight: bold;'+(1?'':'visibility:hidden')+'"><tr  style="color:ff6633"><td width=20></td><td width=150>CATEGORY</td><td width=93>SUB</td><td width=77>SKU</td><td width=173>DESCRIPTION</td><td width=73>&nbsp;&nbsp;PRICE</td><td width=64>CASES</td><td width=73>&nbsp;&nbsp;VOLUME</td></tr>'+
'<tr><form id=total><td></td><td><a onclick="parent.menu.addpr(this);return false" href=""><img src="addskuorange.gif" border=0></a><td colspan=3></td><td align=right><a onclick="parent.menu.total(this);return false;" href="#"><img src="totalsku.gif" border=0></a>&nbsp;</td><td><input name="cases" style="width=64px"></td><td><font color=0>$<input name="total" style="width=64px"></td></form></tr></table></td></tr>'+
dcm.body.innerHTML.substr(b)
} else {
x=dcm.getElementsByTagName('table')[0];
d=x.rows[x.rows.length-1].bgColor;
a=x.insertRow()
y=a
a.bgColor=0;
a.height=2;
b=a.insertCell();
b.colSpan=8;
b=x.rows[0].cloneNode(true)
x.firstChild.appendChild(b)
a=x.insertRow()
a.height=30
a.style.verticalAlign='top'
if(d!='#eeeeee') a.bgColor='eeeeee'
b = dcm.createElement('td')
b.colSpan = 99;
b.appendChild(dcm.createElement("form"));
b.id='new'+(++newdocs)
b.firstElementChild.id = b.id;
b=a.appendChild(b)
for(a=0;a<8;a++) if(xx[a]) {
c=dcm.createElement('td');
if(a<2) c.bgColor='cccccc'
c.innerHTML=xx[a];
b.appendChild(c);
}
c=x.insertRow();
if(d!='#eeeeee') c.bgColor='eeeeee'
for(a=0;a<x.rows[2].cells.length;a++) {
b=x.rows[2].cells[a].cloneNode(false)
d=c.appendChild(b)
}
e=x.rows[2].cells[a-1].innerHTML.split('/tr')
a=e.length-2;
d.innerHTML=e[0]+"/TR><TR><FORM id=total><TD></TD><TD><A onclick=\"parent.menu.addpr(this);return false\" href=\"\">"+
"<IMG src=\"addskuorange.gif\" border=0></A><TD colSpan=3></TD><TD align=right><A onclick=\"parent.menu.total(this);return false;\" href=\"#\"><IMG src=\"totalsku.gif\" border=0></A>&nbsp;</TD><TD><INPUT style=\"WIDTH: 64px\" name=cases></TD><TD><FONT color=0>$<INPUT style=\"WIDTH: 64px\" name=total></FONT></TD></FORM></TR"
+e[a+1];
y.scrollIntoView()
return false
}}

function putx(s) {
var a,x;
x=s.length;
s=x%10+s
x=(x-x%10)/10
s=x%10+s
x=(x-x%10)/10
s=x%10+s
return(s);
}

function autosave() {
return false;
status="Autosave disabled yet.";
return false;
if (astme) status=(astme--)*5+" seconds to auto-save."; else {
beingsaved=0;
if (sve(1)) {
save.innerText = "autosaving...";
s=dcm.forms[0];
f=ifrm.forms[0];
f.ProspectN_FOP.value=s.ProspectN_FOP.value
f.init.value=s.init.value;
if (f.init.value) {
f.submit();
status="Sending data...";
beingsaved=0;
} else {
save.innerText = "";
status="No changes to write...";
}
} else {
save.innerText = "";
status="No changes to write...";
}
astme=36;
}
beingsaved=0;
}

function sve(unchck) {
var y=new Array;
if (beingsaved) { alert('Save in progress...'); return false;} else beingsaved=status='Save in progress';
sv="";
y[0]=0;
for (a=1;a<dcm.forms.length;a++) {
x=dcm.forms[a]
y[a]=0;
x=getTR(x);
var inp = parent.data.getForm(x,"save");
if (inp && (inp.name == "save") && inp.checked) {
	if (x.id!='total') {
		y[a]=1;
		if (x.id) sv+=putx("002id"+x.id);
		if (x.id2) sv+=putx("003id2"+x.id2);
        x = x.querySelectorAll("input,select");
		for (b=0;b<x.length;b++) {
			w=x[b];
			if(w.name!='save') {
			if((w.type=='select-one')) {
				wn=w.name;
				w=w.options[w.selectedIndex];
				if((w.text=='- SELECT -')&&(wn!='Segment')) {
alert('One of your opportunities is missing a '+((x[b].name=='FunnelPosition')?'Stage':x[b].name)+
' entry.\r\nPlease add the '+((x[b].name=='FunnelPosition')?'Stage':x[b].name)+' entry before you save.');
beingsaved=0; return false; }
				if (wn!='FunnelPosition') w=w.text; else w=w.value;
			} else if (w.type=="checkbox") { if (w.checked) w="checked"; else w=""; } else
					if (':Price unit total'.indexOf(w.name)>0) {w=w.value;w=w.replace(/,/g,''); } else w=w.value;
			sv+=putx(putx(x[b].name)+w);
			}
		}
	}
}
}
//if (unchck) { for (a=1;a<dcm.forms.length;a++) if (y[a]) dcm.forms[a].save.checked=false;}
if (dcm.forms[0].init.value) dcm.forms[0].ProspectN_FOP.value=dcm.forms[0].init.value;
dcm.forms[0].init.value=sv;
return true;
}

function gfnum(name) {
var a;
for (a=0;a<generalf.length;a++) if(name==generalf[a]) return (a);
}

function total(th) {
if(!th) return;
var a=1;
var id="$",b,x,gv=0,ct=0;
var totalFrm = th;
th = getTR(th).previousSibling;
x=parent.data.getForm(th,"save");
while(th.id) if (parent.data.getForm(th,"Price")) {
x=parseFloat(parent.data.getForm(th,"unit").value.replace(/,/g,''));
ct+=(isNaN(x))?0:x;
x*=parseFloat(parent.data.getForm(th,"Price").value.replace(/,/g,''));
x=(isNaN(x))?0:x
parent.data.getForm(th,"total").value=putn(x);
gv+=(isNaN(x))?0:x;
th=th.previousSibling;
}

parent.data.getForm(totalFrm,"total").value=putn(gv);
parent.data.getForm(totalFrm,"cases").value=putn(ct);
return gv;
}

function chngopp(th) {
var a=1;
var id="$",b,x;
    if (!parent.data.getForm(th,"save").checked) {
        parent.data.getForm(th,"save").checked=true;
	while (dcm.forms[a].sourceIndex<th.sourceIndex) {
			if (dcm.forms[a].id!=id) b=a
			id=dcm.forms[a].id;
			if (a<dcm.forms.length) a++; else b=a;
	}
	a--;
	dcm.forms[b]["save"].checked=true;
}
}

function getTab(t)
{
    while(t && t.tagName != "TABLE") t = t.parentElement;
    return t;
}
function getTR(t)
{
    while(t && t.tagName != "TR") t = t.parentElement;
    return t;
}
function addpr(th) {
if (beingsaved) {
	alert(beingsaved+" !");
	return false;
}
x=th.parentNode.parentNode.parentNode.parentNode.parentNode.style.visibility="visible";
var a=1;
var id="$",b,x;
while (getTR(dcm.forms[a]) != getTR(th)) {
if (dcm.forms[a].id!=id) b=a
id=dcm.forms[a].id;
if (a<dcm.forms.length) a++; else b=a;
}
a--;
x = getTab(th);
c=x.insertRow(x.rows.length-1);
b = dcm.createElement('td')
b.appendChild(dcm.createElement("form"));
b.colSpan = 99;
c.id=dcm.forms[a].id='new'+(++newdocs);
b.firstElementChild.id = c.id;
c.id2='new'+(++newdocs)
x=c.appendChild(b)
for(a=0;a<8;a++) if(xx[a]) {
d=dcm.createElement('td');
d.innerHTML=xx[a];
x.appendChild(d);
}
}

function prbchng(th) {
var a,b,id=getTR(th).id
if (th.name=='Category') {
	x=th.options[th.selectedIndex].value;
	a=prb('SUB',sub,0,x);
    parent.data.getForm(th, "SUB").outerHTML=a;
    parent.data.getForm(th, "Description").value='';
    parent.data.getForm(th, "Price").value='';
	a=prb('SKU',rest,0,'');
    parent.data.getForm(th, "SKU").outerHTML=a;
	a=prb('Description',rest,0,'');
    parent.data.getForm(th, "Description").outerHTML=a;
} else if (th.name=='SUB') {
	x=th.options[th.selectedIndex].value;
	if (x=='Custom'|x=='ALL') {
	if (x=='ALL') {
		a=prb('SKU','','ALL',0,x);
                parent.data.getForm(th, "SKU").outerHTML=a;
		a=prb('Description','','ALL',0,x);
                parent.data.getForm(th, "Description").outerHTML=a;
	} else {
                parent.data.getForm(th, "SKU").outerHTML='<input name=SKU style="width=77px" onchange=parent.data.getForm(this,\"save\").checked=true>';
                parent.data.getForm(th, "Description").outerHTML='<input name=Description style="width=173px" onchange=parent.data.getForm(this,\"save\").checked=true>';
	}} else {
		a=prb('SKU',rest,0,x);
                parent.data.getForm(th, "SKU").outerHTML=a;
		x=th.options[th.selectedIndex].value;
		a=prb('Description',rest,0,x);
                parent.data.getForm(th, "Description").outerHTML=a;
                parent.data.getForm(th, "Price").value='';
	}
} else if (th.name=='SKU') {
	x=th.options[th.selectedIndex].value;
	if(x!='ALL') {
	if (x) x=x.split('|'); else x='||'.split('|')
	parent.data.getForm(th, "Price").value=x[2];
    parent.data.getForm(th, "Description").options[th.selectedIndex].selected=true;
    } else  parent.data.getForm(th, "Description").selectedIndex=th.selectedIndex;
}
parent.data.getForm(th, "save").checked=true
}

function prb(n,ar,b,par) {
//parent.opener.status='prb '+n+' '+ar.length+' '+par;
c='<option>- SELECT -</option>';
x='';
if (par=='') {
	if (n=='Category') for (a=0;a<ar.length;a++) {
		if(b==ar[a][0]) { sel=' selected'; c=''; allowed=ar[a].join('|'); } else sel='';
		x+='<option value=\"'
		if (n=='Description') {
			if(b==ar[a][1]) { sel=' selected'; c='';}
			x+=escp(ar[a][1])+'"'+sel+'>'+ar[a][1];
		} else x+=escp(ar[a].join('|'))+'"'+sel+'>'+ar[a][0];
		x+='</option>';
	}
} else { if (n=='SUB') {
	par1=par.split('|');
	for (a=0;a<ar.length;a++) if ((parseInt(ar[a][1])>=parseInt(par1[1]))&&(parseInt(ar[a][2])<=parseInt(par1[2]))) {
		if(b==ar[a][0]) { sel=' selected'; c=''; allowed=ar[a].join('|'); } else sel='';
		x+='<option value=\"'+escp(ar[a].join('|'))+'"'+sel+'>'+ar[a][0]+'</option>';
	}
} else {
	par1=par.split('|');
	for (a=parseInt(par1[1])-1;a<parseInt(par1[2]);a++) if((BDmember&&ar[a][0].substr(0,1)!='2')||(!BDmember&&ar[a][0].substr(0,1)!='1')) {
		if(b==ar[a][0].substr(1)) { sel=' selected'; c='';} else sel='';
		x+='<option value=\"'
		if (n=='Description') {
			if(b==ar[a][1]) { sel=' selected'; c='';}
			x+=escp(ar[a][1])+'"'+sel+'>'+ar[a][1];
		} else {
			x+=escp(ar[a][0])+'|';
			x+=escp(ar[a][1])+'|';
			x+=escp(ar[a][2]);
			x+='"'+sel+'>'+ar[a][0].substr(1);
		}
		x+='</option>';
	}
}}
switch (n) {
case 'Category':wdth=150; break;
case 'SUB':wdth=93; x+='<option value=ALL'+((b=='ALL')?' selected':'')+'>ALL</option><option value=Custom'+((b=='Custom')?' selected':'')+'>Custom</option>'; break;
case 'SKU':wdth=77; x+='<option value=ALL'+((b=='ALL')?' selected':'')+'>ALL</option>'; break;
case 'Description':wdth=173; x+='<option value=ALL'+((b=='ALL')?' selected':'')+'>ALL</option>'; break;
}
//parent.opener.status='prb'+n+'end';
return('<select name='+n+' onchange=parent.menu.'+((n=='Description')?'descr':'prbchng')+'(this) style="width='+wdth+'px">'+c+x+'</select>');
}

function stg(stp,b) {
b1=b;
x='';
for (a=0;a<stp.length;a+=2) {
if(b1==stp[a+1]) sel+=' selected'; else sel='';
x+='<option value="'+stp[a+1]+'"'+sel+'>'+stp[a]+'</option>';
}
a='';
b=' onchange="parent.data.getForm(this,\"save\").checked=true">'
+x+'</select>';
x='<select name=\"FunnelPosition\" ';
return(x+b);
}

function prn(b) {
if (!b) return('');
c='<option>- SELECT -</option>';
x='';
for (a=0;a<pn.length;a++) {
if(b==pn[a][0]) { sel=' selected'; c=''; } else sel='';
x+='<option value=\"'+escp(pn[a][0])+'\" '+sel+'>'+pn[a][0]+'</option>';
}
if(b!='$internal$'&&b!=''&&c!='') c='<option value="'+escp(b)+'">'+b+'</option>';
return('<select name=\"ProspectName\" STYLE=\"width=200px\" onchange="parent.data.getForm(this,\'save\').checked=true">'+c+x+'</select>');
}

function arr(x) {
while (x.indexOf('\r')>0) x=x.slice(0,x.indexOf('\r'))+x.slice(x.indexOf('\r')+1,-1);
while (x.indexOf('\n')>0) x=x.slice(0,x.indexOf('\n'))+x.slice(x.indexOf('\n')+1,-1);

var y=new Array;
w=x.substr(0,3);
x=x.substr(3);
s=0;
while (x) {
 var c=new Array(w);
 for(d=0;d<w;d++) {
  e=x.substr(0,3);
  x=x.substr(3);
  c[d]=x.substr(0,e);
  x=x.substr(e);
 }
 if (y[0]) y[s]=c; else y=Array(c);
 s++;
}
return(y)
}

function form0() {
frm=document.forms[0].outerHTML;
frm=frm.substr(0,frm.indexOf('>')+1)+'<div style="visibility:hidden">';
for(a=0;a<document.forms[0].length;a++) {
frm=frm+document.forms[0][a].outerHTML;
}
return(frm+'</form></div><div style="position:absolute;top:0;">')
}

function putn(n) {
n=parseFloat(n.toString().replace(',','.'));
if (n<0) { n=-n; signm='-' } else signm='';
var c=Math.floor(n);
var w,o='';
if(c!=n) {
	o='.'+Math.round((n-c)*100)
}
w=c.toString()
var g=w.length/3;
var g1=Math.floor(g-1/3)
var o1=w.substr(0,w.length-g1*3);
w=w.substr(w.length-g1*3);
while (g1) {
	o1+=','+w.substr(0,3)
	w=w.substr(3)
	g1--;
}
return (signm+o1+o);
}

function numonly(e) {
if('0123456789,.'.indexOf(String.fromCharCode(e.keyCode))<0) e.keyCode='';
}

function escp(xstr) {
return xstr.replace(/"/g,'&#34;').replace(/'/g,'&#39;')
}
</SCRIPT>

<SCRIPT language="JavaScript" type="text/javascript">
<!--
document._domino_target = "_self";
function _doClick(v, o, t, h) {
  var form = document._MatrixUpper;
  if (form.onsubmit) {
     var retVal = form.onsubmit();
     if (typeof retVal == "boolean" && retVal == false)
       return false;
  }
  var target = document._domino_target;
  if (o.href != null) {
    if (o.target != null)
       target = o.target;
  } else {
    if (t != null)
      target = t;
  }
  form.target = target;
  form.__Click.value = v;
  if (h != null)
    form.action += h;
  form.submit();
  return false;
}
// -->
function start() {
    BDmember = parent.menu.document.forms[0].BDorAll.value == 'BD';
    if (window.name == 'data') {
        parent.menu.typem = 1 - parent.menu.typem;
        //	x=parent.menu.document.forms[0].sw[1].checked;
        //	parent.menu.document.forms[0].innerHTML=dcm.forms[0].innerHTML;
        parent.menu.document.forms[0].init.value = dcm.forms[0].init.value;
        parent.menu.beingsaved = 0;
        parent.menu.pos = '0|0|0|0'.split('|');
/*	if (x) {
    parent.menu.document.forms[0].sw[1].checked=true;
    parent.menu.clean(1);
} else */ parent.menu.clean(0);
    } else {
        x = document.getElementsByTagName('DIV')[0];
        x.style.visibility = 'visible';
        b = m.cells;
        for (a = 0; a < b.length; a += 2) {
            b[a].onmouseover = clr
            b[a].onmouseout = clr
            d = b[a].firstChild;
            if (d.tagName == 'TABLE') {
                d.onmouseout = hid
                d.style.left = d.offsetLeft + b[a].offsetWidth - d.offsetWidth + 3;
                d = d.rows;
                for (c = 0; c < d.length; c++) {
                    d[c].cells[0].onmouseover = clr
                    d[c].cells[0].onmouseout = clr
                }
            }
        }
    }
}
</SCRIPT>
    <META name="GENERATOR" content="MSHTML 11.00.9600.18921">
    </HEAD>
    <BODY text="#000000" topmargin="0" leftmargin="0" onmouseover="if(window.name=='menu') this.scrollTop=0" onmouseout="if(window.name=='menu') this.scrollTop=0" onmouseup="if(window.name=='menu') this.scrollTop=0" bgcolor="#ffffff" onload="start()" marginheight="0" marginwidth="0">
        <FORM name="_MatrixUpper" action="/rich.nsf/MatrixUpper?OpenForm&amp;Seq=1&amp;Name=Anonymous&amp;AutoFramed" method="post">
            <INPUT name="__Click" type="hidden" value="0">
            <DIV style="visibility: hidden;">
                <TABLE width="100%" border="0" cellspacing="0" cellpadding="0">
                    <TBODY>
                        <TR height="13">
                            <TD align="right" valign="top" bgcolor="#c1c1c1" colspan="2">
                                <IMG width="78" height="9" onclick="//w98=1;pos='0|0|0|0'.split('|');testing();onl(0)" src="head_pm.gif">
                            </TD>
                        </TR>
                        <TR height="1">
                            <TD colspan="2"></TD>
                        </TR>
                        <TR bgcolor="#ff6633">
                            <TD></TD>
                            <TD width="100%" align="right" nowrap="">
                                <TABLE height="16" style="color: white; font-size: 10px; font-weight: bold; cursor: hand;" cellspacing="0" cellpadding="0">
                                    <TBODY>
                                        <TR id="m">
                                            <TD>
                                                <TABLE width="110" height="90" style="border: 2px solid black; border-image: none; top: 30px; color: white; font-size: 10px; font-weight: bold; visibility: hidden; position: absolute; background-color: rgb(153, 153, 153);">
                                                    <TBODY>
                                                        <TR align="right">
                                                            <TD onclick="if (beingsaved) {alert(beingsaved+' !');return false;};/*if (window.parent.data.frames[0]) {if (window.parent.data.frames[0].frameElement) {window.parent.data.frames[0].frameElement.style.visibility='hidden';window.parent.data.frames[0].redbox.style.visibility='hidden';window.parent.data.frames[0].moveTo(0,window.parent.data.document.body.scrollHeight+130);window.parent.menu.calon=0;}};*/nw();">New Opportunity</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="dcm.body.focus();svcl()">Save</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="dcm.body.focus();svcl(1)">Save &amp;Close</TD>
                                                        </TR>
                                                        <TR align="right" id="ps">
                                                            <TD onclick="dcm.factory.pageSetup()">Page Setup</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="parent.data.print()">Print</TD>
                                                        </TR>
                                                    </TBODY>
                                                </TABLE>
                                                &nbsp;&nbsp;File &nbsp;&nbsp;
                                            </TD>
                                            <TD>|</TD>
                                            <TD>
                                                <TABLE width="83" height="23" style="border: 2px solid black; border-image: none; top: 30px; color: white; font-size: 10px; font-weight: bold; visibility: hidden; position: absolute; background-color: rgb(153, 153, 153);">
                                                    <TBODY>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/SearchForm?OpenForm','displayWindow')">Find/Search </TD>
                                                        </TR>
                                                    </TBODY>
                                                </TABLE>
                                                &nbsp;&nbsp;Edit &nbsp;&nbsp;
                                            </TD>
                                            <TD>|</TD>
                                            <TD>
                                                <TABLE width="70" height="23" style="border: 2px solid black; border-image: none; top: 30px; color: white; font-size: 10px; font-weight: bold; visibility: hidden; position: absolute; background-color: rgb(153, 153, 153);">
                                                    <TBODY>
                                                        <TR align="right">
                                                            <TD>Reports</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="open(dbpath+'/Account?openform', 'displayWindow', 'width=790,height=600,status=no,scrollbars=no,toolbar=no,menubar=no,titlebar=no')">Accounts</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD>News</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD>PM Intro</TD>
                                                        </TR>
                                                    </TBODY>
                                                </TABLE>
                                                &nbsp;&nbsp;View &nbsp;&nbsp;
                                            </TD>
                                            <TD>|</TD>
                                            <TD>
                                                <TABLE width="67" height="23" style="border: 2px solid black; border-image: none; top: 30px; color: white; font-size: 10px; font-weight: bold; visibility: hidden; position: absolute; background-color: rgb(153, 153, 153);">
                                                    <TBODY>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/../feedback.nsf/feedback?OpenForm','Feedback', 'scrollbars=0,resizable=0,width=440,height=380')">Feedback </TD>
                                                        </TR>
                                                    </TBODY>
                                                </TABLE>
                                                &nbsp;&nbsp;Tools &nbsp;&nbsp;
                                            </TD>
                                            <TD>|</TD>
                                            <TD>
                                                <TABLE width="145" height="90" style="border: 2px solid black; border-image: none; top: 30px; color: white; font-size: 10px; font-weight: bold; visibility: hidden; position: absolute; background-color: rgb(153, 153, 153);">
                                                    <TBODY>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/MainHelp/$file/Rich_v2_pl_ chtsht.pdf', 'Help','top=0,left=0,scrollbars=1,resizable=1,width=800,height=650')">Cheatsheet</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/MainHelp/$file/OfflineCheatsheet_b.pdf', 'Help','top=0,left=0,scrollbars=1,resizable=1,width=800,height=650')">Offline</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/MainHelp/$file/FSPipelineDef.pdf', 'Help','top=0,left=0,scrollbars=1,resizable=1,width=800,height=650')">Stage
                  Definitions</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/PMv2Intro?openpage', 'Help','top=0,left=0,scrollbars=1,resizable=1,width=917,height=571')">Navigating the Pipeline</TD>
                                                        </TR>
                                                        <TR align="right">
                                                            <TD onclick="window.open(dbpath+'/FAQ?openpage', 'Help','top=0,left=0,scrollbars=1,resizable=1,width=800,height=600')">FAQ</TD>
                                                        </TR>
                                                    </TBODY>
                                                </TABLE>
&nbsp;&nbsp;Help &nbsp;&nbsp;
                                            </TD>
                                            <TD>|</TD>
                                            <TD onclick="parent.onbeforeunload='';&#10;ans=makeMsgBox('','Do you wish to save your work?',48,3,512,0);&#10;if(ans==2) return false;&#10;parent.document.body.onbeforeunload=''&#10;if(ans==6) if(sve(0)) {/*a=window.open(h,'');*/f=dcm.forms[0];f.Stages.value='hangup';f.submit();} else {beingsaved=0;}&#10;return false">&nbsp;&nbsp;Home &nbsp;&nbsp;</TD>
                                        </TR>
                                    </TBODY>
                                </TABLE>
                                <TR height="2">
                                    <TD bgcolor="#0" colspan="2"></TD>
                                </TR>
                    </TBODY>
                </TABLE>
                <TABLE width="100%">
                    <TBODY>
                        <TR>
                            <TD>
                                <B>
                                    <FONT color="#ffa814">
                                        OPPORTUNITY MATRIX<BR>
                                    </FONT>
                                    &nbsp;Demo User<BR>
                                    <DIV id="save" style="color: red; font-size: 10px; font-weight: bold;"></DIV>
                                </B>
                            </TD>
                            <TD align="right">
                                <B>
                                    PIPELINE TOTAL:
                                    <B>
                                        <FONT face="Verdana" size="2">$:</FONT>
                                    </B>
                                    <B>
                                        <FONT face="Verdana" size="2">
                                            <INPUT name="totalall" style="font-size: 12px;" size="12">
                                        </FONT>
                                    </B>
                                    <B>
                                        <FONT face="Verdana" size="2">C:</FONT>
                                    </B>
                                    <B>
                                        <FONT face="Verdana" size="2">
                                            <INPUT name="cases" style="font-size: 12px;" size="12">
                                        </FONT>
                                    </B>
                                </B>
                            </TD>
                            <TD>
                                <A onclick="//parent.menu.totalall();" href="#">
                                    <IMG width="59" height="15" src="totalall.gif" border="1">
                                </A>
                            </TD>
                        </TR>
                    </TBODY>
                </TABLE>
            </DIV>
<SCRIPT language="VBScript">
Function makeMsgBox(tit,mess,icon,buts,defs,mode)
   butVal = icon + buts + defs + mode
   makeMsgBox = MsgBox(mess,butVal,tit)
End Function
</SCRIPT>
            <DIV style="display: none;">
                <BR>
                <INPUT name="query_string_decoded" style="display: none;" value="OpenForm&amp;Name=Anonymous&amp;AutoFramed">
                <INPUT name="UserName" style="display: none;" value="Anonymous">
                <FONT face="Verdana" size="2">
                    <TEXTAREA name="ProspectN_FOP" style="display: none;" rows="7" cols="50">014Demo Account 1014Demo Account 2014Demo Account 3</TEXTAREA>
                </FONT>
                <TEXTAREA name="ProductCats" style="display: none;" rows="7" cols="50"></TEXTAREA>
                <INPUT name="Stages" style="display: none;" value="Opp Matrix|Opp Matrix|Prospect|1|Qualify|2|Sponsor/Coach|3|Solve|4|Final Solution|5|Close|6|Reservoir|Reservoir">
                <TEXTAREA name="init" style="display: none;" rows="7" cols="50"></TEXTAREA>
                <TEXTAREA name="ProductSubs" style="display: none;" rows="7" cols="50"></TEXTAREA>
                <TEXTAREA name="ProductLines" style="display: none;" rows="7" cols="50"></TEXTAREA>
                <INPUT name="BDorAll" value="FS">
                <!--iframe src="hangup?openform&name=Anonymous"></iframe>-->
                <IFRAME width="160" height="150" src="calendar.htm" frameborder="0" style="position: absolute;" bordercolor="F0F0FF"></IFRAME>
            </DIV>
        </FORM>
<SCRIPT language="JScript">
var posm;
function onl(type) {
if(posm) pos=posm.split('|');
parent.data.document.body.innerHTML='';
save.innerText = "";
stv=0;
status="Building form..."
var d=String.fromCharCode(158);
//pg=arr('003'+document.forms[0].ProductCats.value);
//sub=arr('003'+document.forms[0].ProductSubs.value);
pn=arr('001'+document.forms[0].ProspectN_FOP.value);
pn=pn.sort();
st=document.forms[0].Stages.value.split('|');
if (document.forms[0].init.value=='') {pl=new Array ('|fdfd'.split('|'));} else pl=arr('016'+document.forms[0].init.value);
if(pl.length>maxopps&&w98) document.ps.style.display='none';
del='<img src="x2.gif" onclick=parent.menu.dlt(event.srcElement)>'
itot='<input name="total" style="width=64px">';
ac=0;
ap='<IMG SRC="addSKUs.gif" onMouseDown="parent.menu.addpr(this)"><br>'
+'<IMG SRC="blue_total.gif" onMouseDown="parent.menu.total(this);return false">';
xx[0]='<input type=checkbox name="save" style="display:none">'+del
xx[1]=prb('Category',pg,0,'')
xx[2]=prb('SUB',sub,0,'')
xx[3]=prb('SKU',rest,0,'')
xx[4]=prb('Description',rest,0,'')
xx[5]='$<input name=Price onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" onKeyPress="parent.menu.numonly(event);">'
xx[6]='<input name=unit onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" onKeyPress="parent.menu.numonly(event);">'
xx[7]='$<input name=total onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" onKeyPress="parent.menu.numonly(event);">'

hrc='FFFFFF';
if(pl.length<(maxopps+1)||!w98) q="<!-- MeadCo ScriptX --><object id=factory style='display:none' classid='clsid:1663ed61-23eb-11d2-b92f-008048fdd814' codebase='http://www.meadroid.com/scriptx/ScriptX.cab#Version=6,1,429,14'></object>"; else q="";
q+=form0()+'<iframe id=clndr src="OpportunityMatrixSPA\calendar.htm" style="position:absolute; visibility:hidden" width=155 height=150 FRAMEBORDER=0></iframe><table border=0 cellpadding=0 cellspacing=0 style="border:solid;border-width:2;border-color:FF6633;color:FF6633;font-weight:bold;font-size:10;font-family:Verdana">';

pr=pl[parseInt(pos[0])][0].substr(1,32);
typep=gfnum('FunnelPosition');
typec=1;
addsku=0;
for(ac=parseInt(pos[0]);document.forms[0].init.value && (ac<pl.length);ac++) if ((pl[ac][typep]=='Opp Matrix')||(pl[ac][typep]=='Matrix Action')||type&&ac>=pos[0]) {
if(!pos[0]||ac<pos[0]) {pos[0]=ac;pos[1]=ac;}
pos[3]++;
if(pl[ac][3])pos[3]++;
if((pr)&&pr!=pl[ac][0].substr(1,32)) if(pos[3]>=maxopps&&w98) break;
pos[2]=ac;
typec=0;
if ((!pr)||(pr==pl[ac][0].substr(1,32))) { //předchozí přeskočen nebo přidáváš SKU
   pr='';
} else { // nový Prospekt
   if((!pl[ac][3])&&ac==pl.length+1) { pr='</table></td></tr><tr><td colspan=8 bgcolor=0 height=2></td></tr>';
   } else { // je tu SKU
//      pos[2]=ac;
      pr='<tr><form id=total><td></td><td><a onclick="parent.menu.addpr(this);return false" href=""><img src="addskuorange.gif" border=0></a><td colspan=3></td><td align=right><a onclick="parent.menu.total(this);return false;" href="#"><img src="totalsku.gif" border=0></a>&nbsp;</td><td><input name="cases" style="width=64px"></td><td><font color=0>$<input name="total" style="width=64px"></td></form></tr></table></td></tr><tr><td colspan=8 bgcolor=0 height=2></td></tr>'
   }
}
   x=prn(pl[ac][gfnum('ProspectName')]);
   q+=pr;
   if(pr.indexOf('addsku')>0) addsku++;
   if (x) {
//      pos[3]++;
      if (hrc=='EeEeEe') hrc='FFFFFF'; else hrc='EeEeEe';
      x+='<br><a href="javascript:parent.menu.wo(\'ViewActionPlans?openform&docid='+pl[ac][0].substr(1,32)+'\',\'width=600,height=400,status=0\')">';
      if (pl[ac][0].substr(0,1)=='1') x+='<font color="FF0000">';
      x+='Action Plan.</a>';
      q+='<tr valign=top>'+prhd+'</tr><tr bgcolor='+hrc+' valign=top height=40><form id='+pl[ac][0].substr(1,32)+' id2='+pl[ac][gfnum('prunid')].substr(0,32)+'><td bgcolor=cccccc>'+(((pos[0]==ac)&&(pl.length>maxopps)&&w98&&ac>0)?'<img src="prev.gif" style="cursor:hand;position:absolute;left:800;top:0" onclick=parent.menu.prev()>':'');
      q+='<input type=checkbox name=pr '+pl[ac][gfnum('Priority')]+' onclick=\'this.value=(this.checked)?"checked":"";parent.data.getForm(this,\"save\").checked=true;\')></td><td bgcolor=cccccc>'
+'<input name=num size=3  value="'+escp(pl[ac][gfnum('PriorityN')])+'" onchange="parent.data.getForm(this,\"save\").checked=true"></td><td><input type=checkbox name=save style="display:none">'+del+'</td><td>'+x+'</td><td>';
   } else q=q+'<tr bgcolor='+hrc+'><td></td><td colspan=7>'

if(x) { q+='<input name=Initiative value=\"'
 +escp(pl[ac][gfnum('Initiative')])+'\" onchange=parent.data.getForm(this,\"save\").checked=true style="width:155px"></td><td>'
 +(isBD?'':slct('Segment',seg,pl[ac][gfnum('Segment')])+'</td><td>')
 +stg(st,pl[ac][gfnum('FunnelPosition')])+'</td><td>'
 +'<input name=ShipDate onchange=parent.data.getForm(this,\"save\").checked=true size=11 value="'+escp(pl[ac][gfnum('ShipDate')])+'"></td>' // readonly onclick="document.frames[0].calendar(this,event.clientY+document.body.scrollTop,event.clientX)"
+'</form></tr>'
+'<tr bgcolor='+hrc+'><td bgcolor=cccccc colspan=2><td colspan=4 align=right><table border=0 cellpadding=0 cellspacing=0 style="font-size:12px; font-weight: bold;'+((pl[ac][gfnum('prunid')].substr(0,32)||1)?'':'visibility:hidden')+'"><tr  style="color:ff6633"><td width=20></td><td width=150>CATEGORY</td><td width=93>SUB</td><td width=77>SKU</td><td width=173>DESCRIPTION</td><td width=73>&nbsp;&nbsp;PRICE</td><td width=64>CASES</td><td width=73>&nbsp;&nbsp;VOLUME</td></tr><tr  bgcolor='+hrc+'>'; }
{//nic
if (x) {q+='<td colspan=7>'}
if (pl[ac][gfnum('prunid')].substr(0,32)) {
   q+='<tr><form id='+pl[ac][0].substr(1,32)+' id2='+pl[ac][gfnum('prunid')].substr(0,32)+'></td><td >'
   allowed='';
   q+='<input type=checkbox name=save style="display:none">'+del+'</td><td>'
+prb('Category',pg,pl[ac][gfnum('Category')],'')+'</td><td>';
   q+=prb('SUB',sub,pl[ac][gfnum('SUB')],allowed)+'</td><td>'
   if (pl[ac][gfnum('SUB')]=='Custom') q+='<input name=SKU style="width=77px" onchange=parent.data.getForm(this,\"save\").checked=true value="'+escp(pl[ac][gfnum('SKU')])+'"></td><td><input name=Description style="width=173px" onchange=parent.data.getForm(this,\"save\").checked=true value="'+escp(pl[ac][gfnum('Description')])+'"></td><td>';
   else q+=prb('SKU',rest,pl[ac][gfnum('SKU')],allowed)+'</td><td>'
+prb('Description',rest,pl[ac][gfnum('Description')],allowed)+'</td><td>';
   q+='$<input name=Price onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" value=\"'
+escp(putn(pl[ac][gfnum('Price')]))+'\"></td><td>'
+'<input name=unit onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" value=\"'
+escp(putn(pl[ac][gfnum('unit')]))+'\"></td><td>'
+'$<input name=total onchange=parent.data.getForm(this,\"save\").checked=true style="width=64px" value=\"'
+escp(putn(pl[ac][gfnum('Total')]))+'\">';
   q+='</td></form></tr>';
}
q+='</td></tr>';}//nic
//blbost if(ac==pl.length-1) dcm.body.innerHTML+=pr;
pr=pl[ac][0].substr(1,32);
} else { //after for
   if ((pr)&&(pr!=pl[ac][0].substr(1,32))) { q+='<tr><form id=total><td></td><td><a onclick="parent.menu.addpr(this);return false" href=""><img src="addskuorange.gif" border=0></a><td colspan=3></td><td align=right><a onclick="parent.menu.total(this);return false;" href="#"><img src="totalsku.gif" border=0></a>&nbsp;</td><td><input name="cases" style="width=64px"></td><td><font color=0>$<input name="total" style="width=64px"></td></form></tr></table></td></tr><tr><td colspan=8 bgcolor=0 height=2></td></tr>';
}
   pr='';
//end of for loop
}
if ((document.forms[0].init.value=='')||typec) {
var xy=new Array;
xy[0]='<input type=checkbox name=pr onclick=\'this.value=(this.checked)?"checked":"";parent.data.getForm(this,\"save\").checked=true;\')>'
xy[1]='<input name=num size=3 onchange="parent.data.getForm(this,\"save\").checked=true">'
xy[2]='<input type=checkbox name=save style="display:none">';//+del
xy[3]=prn('$internal$');
xy[4]='<input name=Initiative onchange=parent.data.getForm(this,\"save\").checked=true style="width:155px">'
xy[5]=(isBD?'':slct('Segment',seg,''))
xy[6]=stg(st)
xy[7]='<input name=ShipDate onchange=parent.data.getForm(this,\"save\").checked=true size=11>'; // readonly onclick="document.frames[0].calendar(this,event.clientY+document.body.scrollTop,event.clientX)"
   if(pl.length<(maxopps+1)||!w98) a="<!-- MeadCo ScriptX --><object id=factory style='display:none' classid='clsid:1663ed61-23eb-11d2-b92f-008048fdd814' codebase='http://www.meadroid.com/scriptx/ScriptX.cab#Version=6,1,429,14'></object>"; else a="";
   a+="<!-- MeadCo ScriptX --><object id=factory style='display:none' classid='clsid:1663ed61-23eb-11d2-b92f-008048fdd814' codebase='http://www.meadroid.com/scriptx/ScriptX.cab#Version=6,1,429,14'></object>"+form0()+'<iframe id=clndr src="calendar?openpage" style="position:absolute; visibility:hidden" width=155 height=150 FRAMEBORDER=0></iframe><table border=0 cellpadding=0 cellspacing=0 style="border:solid;border-width:2;border-color:FF6633;color:FF6633;font-weight:bold;font-size:10;font-family:Verdana">'+
'<tr>'+prhd+'</tr><tr valign=top height=30 id=new0><form>';
for(b=0;b<8;b++) if(xy[b]) {
	a+='<td'+((b<2)?' bgcolor=cccccc':'')+'>'+xy[b]+'</td>'
}
a+='</form></tr>'
a+='<tr><td bgcolor=CCCCCC colspan=2></td><td colspan=4 align=right><table border=0 cellpadding=0 cellspacing=0 style="font-size:12px; font-weight: bold;'+(1?'':'visibility:hidden')+'"><tr  style="color:ff6633"><td width=20></td><td width=150>CATEGORY</td><td width=93>SUB</td><td width=77>SKU</td><td width=173>DESCRIPTION</td><td width=73>&nbsp;&nbsp;PRICE</td><td width=64>CASES</td><td width=73>&nbsp;&nbsp;VOLUME</td></tr>'+
'<tr><form id=total><td></td><td><a onclick="parent.menu.addpr(this);return false" href=""><img src="addskuorange.gif" border=0></a><td colspan=3></td><td align=right><a onclick="parent.menu.total(this);return false;" href="#"><img src="totalsku.gif" border=0></a>&nbsp;</td><td><input name="cases" style="width=64px"></td><td><font color=0>$<input name="total" style="width=64px"></td></form></tr></table></td></tr>';
dcm=parent.data.document;
parent.data.document.body.innerHTML=a;
/*   dcm.body.innerHTML+=form0()+'<iframe id=clndr src="calendar?openpage" style="position:absolute; visibility:hidden" width=155 height=150 FRAMEBORDER=0></iframe><table border=0 cellpadding=0 cellspacing=0 style="border:solid;border-width:2;border-color:FF6633;color:FF6633;font-weight:bold;font-size:10;font-family:Verdana">';
*/   hrc='FFFFFF';
//   nw(1)
} else {
   x='<tr><form id=total><td></td><td><a onclick="parent.menu.addpr(this);return false" href=""><img src="addskuorange.gif" border=0></a><td colspan=3></td><td align=right><a onclick="parent.menu.total(this);return false" href="#"><img src="totalsku.gif" border=0></a>&nbsp;</td><td><input name="cases" style="width=64px"></td><td><font color=0>$<input name="total" style="width=64px"></td></form></tr></table></td></tr><tr><td colspan=8 bgcolor=0 height=2></td></tr>';
   if (hrc=='EeEeEe') hrc='FFFFFF'; else hrc='EeEeEe';
   if (q.substr(q.length-x.length).indexOf('addsku')<0) q+=x;
   if(q.substr(q.length-'<tr><td colspan=8 bgcolor=0 height=2></td></tr>'.length)=='<tr><td colspan=8 bgcolor=0 height=2></td></tr>') q=q.substr(0,q.length-'<tr><td colspan=8 bgcolor=0 height=2></td></tr>'.length)
dcm.body.innerHTML+=q+
'</table>'+(((pl.length>maxopps)&&w98&&(ac<pl.length))?'<img src="next.gif" style="cursor:hand;position:relative;left:800;top:-48" onclick=parent.menu.next()></div>':'</div>');
}
totalall()
if(document.forms[0].init.value!='' && parent.n) nw();
//interv=window.setInterval("autosave()",5000)
//alert(pos)
}
</SCRIPT>
</BODY>
</HTML>
